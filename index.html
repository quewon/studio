<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>text studio</title>
    <style media="screen">
      :root {
        --lightergray: rgb(230, 230, 230);
      }

      body {
        margin: auto;
        padding: .5rem;
        max-width: 50rem;
        font-family: serif;
      }

      h1 {
        scale: 1 1.5;
      }

      button {
        font-size: inherit;
        font-family: inherit;
        cursor: pointer;

        border: 1px solid black;
        border-radius: 3px;
        background: white;
      }
      button:not(:disabled):active {
        background: var(--lightergray);
      }
      button[checked] {
        background: rgba(255, 0, 0, .1);
      }
      button:disabled {
        border-color: var(--lightergray) !important;
        color: var(--lightergray) !important;
        cursor: auto;
      }

      .flex {
        display: flex;
        gap: .25rem;
      }
      .flex.column {
        flex-direction: column;
      }
      .flex .grow {
        flex-grow: 1;
      }

      .noselect {
        -webkit-touch-callout: none; /* iOS Safari */
          -webkit-user-select: none; /* Safari */
           -khtml-user-select: none; /* Konqueror HTML */
             -moz-user-select: none; /* Old versions of Firefox */
              -ms-user-select: none; /* Internet Explorer/Edge */
                  user-select: none; /* Non-prefixed version, currently
                                        supported by Chrome, Edge, Opera and Firefox */
      }

      #timeline-info {
        font-family: monospace;
        margin-top: .5rem;
      }
      #timeline {
        position: relative;
        overflow: visible;
        display: flex;
        flex-direction: column;
        margin-bottom: .5rem;
      }

      .track {
        position: relative;
        width: 100%;
        height: 1.5rem;
        border-bottom: 1px solid var(--lightergray);
      }
      .track .track-selector {
        position: absolute;
        left: 0;
        top: 50%;
        translate: -100% -50%;
        height: inherit;
        width: .5rem;
        height: .5rem;
        border-radius: 50%;
      }
      .track.selected .track-selector {
        background: orange;
      }

      .track.locked .clip {
        pointer-events: none;
      }
      .track.locked.selected .track-selector {
        background: gray;
      }

      /* clip */
      .track .clip {
        position: absolute;
        height: inherit;
        background: lightgray;
        opacity: .5;
        border-radius: 5px;
        overflow: hidden;

        cursor: grab;
      }
      body:not(.resizing) .track  .clip:hover {
        background: var(--lightergray);
      }
      .track .clip.selected {
        background: orange !important;
      }

      .resize-handle {
        position: absolute;
        height: inherit;
        width: 3px;

        cursor: ew-resize;

        right: 0;
      }
      .resize-handle:first-child {
        left: 0;
      }

      #playhead {
        position: absolute;
        height: 100%;
        border-left: 1px solid;
        border-right: 1px solid;
        border-color: black;
        translate: -50% 0;
        pointer-events: none;
        z-index: 10;
      }
      #playhead::before {
        content: "";
        display: block;
        position: absolute;
        top: 0;
        height: .75rem;
        width: .75rem;
        translate: -50% 0;
        background: black;
        border-radius: 50%;
      }

      body.recording #playhead {
        border-color: red;
      }
      body.recording #playhead::before {
        background: red;
      }

      #timeline-ruler {
        height: .75rem;
        width: 100%;
        background-image: linear-gradient(90deg, black 0px, black 1px, var(--lightergray) 1px, var(--lightergray) 100%);
        background-size: 0 100%;
      }

      .timeline-event {
        position: absolute;
        height: inherit;
        width: 1px;
        pointer-events: none;
      }
      .timeline-event.keydown {
        background: black;
      }
      .timeline-event.keyup {
        background: white;
      }

      #component-log, #inspector {
        max-height: 10rem;
        pointer-events: auto;
        border: 1px solid black;
        padding: .5rem;
        overflow-y: scroll;
        font-family: monospace;
      }

      #component-log {
        width: 100%;
      }
      #component-log div:first-child {
        margin-bottom: .5rem;
      }
      #component-log button {
        color: black;
        text-align: left;
      }
      #component-log button.trimmed {
        border-color: lightgray;
        color: lightgray;
      }

      #inspector {
        width: 65rem;
        height: fit-content;
      }
      #inspector > div {
        display: none;
        white-space: pre;
      }
      #inspector.track #track-inspector {
        display: block;
      }
      #inspector.clip #clip-inspector {
        display: block;
      }
      #inspector.event #event-inspector {
        display: block;
      }
      #inspector::before {
        margin-bottom: .5rem;
      }
      #inspector.track::before {
        content: "TRACK INSPECTOR";
      }
      #inspector.clip::before {
        content: "CLIP INSPECTOR";
      }
      #inspector.event::before {
        content: "EVENT INSPECTOR";
      }

      #event-inspector [name='listen']::before {
        content: "listen";
      }
      #inspector.listening #event-inspector [name='listen']::before {
        content: "stop listening";
      }
      #event-inspector [name='listening'] {
        display: none;
      }
      #inspector.listening #event-inspector [name='listening'] {
        display: inline;
      }

      #track-inspector [name='lock']::after {
        content: "lock track"
      }
      #track-inspector [name='lock'][checked]::after {
        content: "unlock track"
      }

      input {
        line-height: inherit;
        font-family: inherit;
        font-size: inherit;
      }

      .visualizer {
        width: 100%;
        height: 3rem;
        /* border-bottom: 1px solid var(--text); */
        box-sizing: border-box;
        display: grid;
        grid-template-columns: repeat(26, 1fr);
      }
      .visualizer > div {
        text-align: center;
        background: lightgray;
        align-self: end;
        color: transparent;
        height: 0%;
      }
      body.recording .visualizer > div {
        background: black;
      }

      button[name='record']::before {
        content: "record"
      }
      body.recording button[name='record']::before {
        content: "stop recording"
      }

      button[name='track']::before {
        content: "+ track"
      }

      button[name='tostart']::before {
        content: "<|"
      }
      button[name='toend']::before {
        content: "|>"
      }
      button[name='play']::before {
        content: "play"
      }
      body.playing button[name='play']::before {
        content: "stop"
      }

      .output {
        font-family: monospace;
        white-space: pre-wrap;
        word-break: break-word;
        pointer-events: none;

        -webkit-touch-callout: none; /* iOS Safari */
          -webkit-user-select: none; /* Safari */
           -khtml-user-select: none; /* Konqueror HTML */
             -moz-user-select: none; /* Old versions of Firefox */
              -ms-user-select: none; /* Internet Explorer/Edge */
                  user-select: none; /* Non-prefixed version, currently
                                        supported by Chrome, Edge, Opera and Firefox */
      }
      .output .caret {
        display: inline;
        min-width: 1ch;
        min-height: 1em;
        background: black;
        color: white;
      }
      .caret:empty::before {
        content: "_";
      }

      .output.recording {
        color: red;
      }
      .output.recording .caret {
        background: red;
      }

      body.dragging, body.dragging * {
        cursor: grabbing !important;
      }

      body.resizing, body.resizing * {
        cursor: ew-resize;
      }

      .noclick {
        pointer-events: none;
      }

      .serif {
        font-family: serif;
      }

      .gone {
        display: none;
      }
    </style>
  </head>
  <body>

    <header class="noclick noselect">
      <h2 style="margin-bottom: -1.5rem; margin-left: 1.5rem; font-style: italic;">quewon's</h2>
      <h1>live text recording studio</h1>
    </header>
    <div id="timeline-controls" class="flex" class="noselect">
      <button onclick="createTrack()" name="track"></button>
      <button onclick="currentTrack.toggleRecording(event)" name="record"></button>
      <button onclick="setPlayheadTime(0)" name="tostart"></button>
      <button onclick="togglePlaying()" name="play"></button>
      <button onclick="setPlayheadTime(totalTime)" name="toend"></button>
      <div class="grow"></div>
      <button class="noselect" onclick="toggleSetting('startRecordOnInput', this)">start recording on keydown</button>
      <button class="noselect" onclick="toggleSetting('clearWithEnter', this)">clear with enter</button>
    </div>
    <div id="timeline-info" class="noclick noselect"></div>
    <div id="timeline">
      <div id="timeline-ruler"></div>
      <div id="playhead"></div>
    </div>
    <div class="flex noclick">
      <div id="component-log" class="flex column">

      </div>
      <div id="inspector" class="flex column">
        <div id="track-inspector"><button name="lock" class="serif"></button>
<button disabled name="delete" class="serif">delete track</button></div>

        <div id="clip-inspector"><button name="delete" class="serif">delete clip</button></div>

        <div id="event-inspector">            TYPE: <button name="keydown" checked>keydown</button> <button name="keyup">keyup</button>

            CODE: <span name="code">a</span>
             KEY: <span name="key">a</span> <button name="listen" class="serif"></button> <span name="listening"><i>listening...</i></span>

 LOCAL TIMESTAMP: <input type="number" name="local" value="0">
GLOBAL TIMESTAMP: <input type="number" name="global" value="0">

                  <button name="delete" class="serif">delete event</button></div>
      </div>
    </div>
    <br>
    <i class="noclick noselect" style="color: gray">hit record to start capturing keyboard input.</i><br><br>

  </body>

  <script type="text/javascript" src="js/hangul.min.js"></script>
  <script type="text/javascript" src="js/toolbox.js"></script>
  <script type="text/javascript" src="js/recording.js"></script>
  <script type="text/javascript" src="js/inputsim.js"></script>
  <script type="text/javascript" src="js/engine.js"></script>
</html>
